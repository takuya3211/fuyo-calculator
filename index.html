<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ‰¶é¤Šãƒ©ã‚¤ãƒ³åˆ¤å®šãƒ„ãƒ¼ãƒ« 2025å¹´æœ€æ–°ç‰ˆï½œå¹´åã®å£ã‚’ä¸€ç™ºãƒã‚§ãƒƒã‚¯ | kurashicalc</title>
<meta name="description" content="2025å¹´ç¨åˆ¶æ”¹æ­£å¯¾å¿œã€‚å¹´åã¨å‹¤å‹™æ¡ä»¶ã‚’å…¥åŠ›ã™ã‚‹ã ã‘ã§ã€ç¨é‡‘ãƒ»ç¤¾ä¼šä¿é™ºãƒ»é…å¶è€…æ§é™¤ï¼ˆç‰¹åˆ¥æ§é™¤ï¼‰ã¸ã®å½±éŸ¿ã‚’æ¦‚ç®—ã§åˆ¤å®šã—ã¾ã™ã€‚">
<link rel="stylesheet" href="style.css">
<style>
.hero {
  background: var(--bg2); border-bottom: 1px solid var(--border);
  padding: 56px 24px 40px; text-align: center;
}
.hero-badge {
  display: inline-block; background: var(--accent); color: #fff;
  font-family: 'DM Mono', monospace; font-size: 11px; letter-spacing: 0.12em;
  padding: 4px 12px; border-radius: 2px; margin-bottom: 20px;
}
.hero h1 {
  font-family: 'Shippori Mincho', serif;
  font-size: clamp(26px, 5.5vw, 48px); font-weight: 800;
  line-height: 1.25; letter-spacing: -0.02em; margin-bottom: 16px;
}
.hero h1 em { font-style: normal; color: var(--accent); border-bottom: 3px solid var(--accent); padding-bottom: 1px; }
.hero-sub { font-size: 14px; color: var(--text2); max-width: 520px; margin: 0 auto 14px; line-height: 1.8; }
.hero-update {
  display: inline-flex; align-items: center; gap: 6px;
  font-family: 'DM Mono', monospace; font-size: 12px; color: var(--muted);
}
.hero-update::before { content: 'â—'; font-size: 9px; color: var(--green); }
.walls-strip { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; padding: 18px 24px 0; }
.wall-pill {
  border: 1px solid var(--border); background: var(--surface);
  border-radius: 20px; padding: 5px 14px;
  font-family: 'DM Mono', monospace; font-size: 12px; color: var(--text2);
}
.slider-section { margin-bottom: 28px; }
.slider-display { text-align: center; margin-bottom: 14px; }
.slider-display .s-label { font-size: 13px; color: var(--muted); font-family: 'DM Mono', monospace; margin-bottom: 2px; }
.slider-display .s-amount { font-family: 'Shippori Mincho', serif; font-size: 42px; font-weight: 800; color: var(--accent); line-height: 1; }
.slider-display .s-unit { font-size: 16px; color: var(--text2); margin-left: 2px; }
.slider-ticks { display: flex; justify-content: space-between; font-family: 'DM Mono', monospace; font-size: 11px; color: var(--muted); margin-top: 6px; }
.form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 28px; }
@media(max-width:540px){ .form-grid { grid-template-columns: 1fr; } }

/* ä¸–å¸¯æ‰‹å–ã‚Šæ¯”è¼ƒ */
.household-card {
  background: var(--card); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 28px; margin-bottom: 20px;
  box-shadow: var(--shadow);
}
.household-title {
  font-size: 14px; font-weight: 700; margin-bottom: 20px;
  display: flex; align-items: center; gap: 8px;
}
.household-title::before { content:''; width:4px; height:18px; background:var(--accent); border-radius:2px; flex-shrink:0; }
.hh-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px; }
@media(max-width:480px){ .hh-grid { grid-template-columns: 1fr; } }
.hh-box {
  background: var(--bg); border: 1px solid var(--border);
  border-radius: var(--radius-sm); padding: 18px; text-align: center;
}
.hh-box.highlight { border-color: var(--green); background: var(--green-bg); }
.hh-box.highlight-warn { border-color: var(--red); background: var(--red-bg); }
.hh-label { font-size: 11px; color: var(--muted); font-family:'DM Mono',monospace; margin-bottom: 6px; }
.hh-amount { font-family:'DM Mono',monospace; font-size: 22px; font-weight:700; color: var(--text); }
.hh-box.highlight .hh-amount { color: var(--green); }
.hh-box.highlight-warn .hh-amount { color: var(--red); }
.hh-sub { font-size: 11px; color: var(--muted); margin-top: 4px; font-family:'DM Mono',monospace; }
.hh-diff { text-align:center; font-size:15px; padding: 12px; background: var(--bg2); border-radius: var(--radius-sm); }

/* é…å¶è€…æ§é™¤ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */
.deduction-bar-card {
  background: var(--card); border: 1px solid var(--border);
  border-radius: var(--radius); overflow: hidden; margin-bottom: 20px;
  box-shadow: var(--shadow);
}
.deduction-bar-head {
  padding: 14px 24px; border-bottom: 1px solid var(--border);
  font-family:'DM Mono',monospace; font-size:11px; letter-spacing:0.14em;
  color: var(--accent); background: var(--bg2);
}
.ded-row {
  display: flex; align-items: center; padding: 14px 24px;
  border-bottom: 1px solid var(--border); gap: 14px;
}
.ded-row:last-child { border-bottom: none; }
.ded-label { flex: 1; font-size: 13px; color: var(--text2); }
.ded-label strong { display: block; font-size: 14px; color: var(--text); margin-bottom: 2px; }
.ded-amount { font-family:'DM Mono',monospace; font-size:15px; font-weight:700; width: 110px; text-align: right; flex-shrink: 0; }
.ded-amount.active { color: var(--green); }
.ded-amount.zero { color: var(--muted); }

/* å°ã•ã‚æ³¨è¨˜ */
.small-note {
  font-size: 11px; color: var(--muted);
  font-family: 'DM Mono', monospace; line-height: 1.85;
  margin-top: 10px;
}
</style>
</head>
<body>

<nav class="site-nav">
  <a href="/" class="logo">kurashicalc</a>
  <div class="nav-links">
    <a href="/" class="hide-sp">ãƒ„ãƒ¼ãƒ«</a>
    <a href="/article-103man-wall.html" class="hide-sp">è¨˜äº‹</a>
    <a href="/privacy.html" class="hide-sp">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
    <a href="/contact.html">ãŠå•ã„åˆã‚ã›</a>
  </div>
</nav>

<div class="hero anim-down">
  <div class="hero-badge">2025å¹´ï¼ˆä»¤å’Œ7å¹´åˆ†ï¼‰ç¨åˆ¶æ”¹æ­£ å¯¾å¿œ</div>
  <h1>æ‰¶é¤Šãƒ©ã‚¤ãƒ³<em>åˆ¤å®š</em>ãƒ„ãƒ¼ãƒ«</h1>
  <p class="hero-sub">
    å¹´åã¨å‹¤å‹™æ¡ä»¶ã‚’å…¥åŠ›ã™ã‚‹ã ã‘ã§ã€ç¨é‡‘ãƒ»ç¤¾ä¼šä¿é™ºãƒ»é…å¶è€…æ§é™¤ï¼ˆç‰¹åˆ¥æ§é™¤ï¼‰ã®å½±éŸ¿ã‚’æ¦‚ç®—ã§åˆ¤å®šã—ã¾ã™ã€‚<br>
    â€» ç¤¾ä¼šä¿é™ºã¯ã€ŒçŸ­æ™‚é–“åŠ´åƒè€…ã®åŠ å…¥è¦ä»¶ï¼ˆé€±20hãƒ»æœˆ8.8ä¸‡å††ãªã©ï¼‰ã€ã‚‚å…¥åŠ›æ¡ä»¶ã«å«ã‚ã¾ã—ãŸï¼ˆæ¦‚ç®—ï¼‰ã€‚
  </p>
  <div class="hero-update">é…å¶è€…æ§é™¤ãƒ»ä¸–å¸¯æ‰‹å–ã‚Šã¸ã®å½±éŸ¿ã‚‚è¨ˆç®—</div>
  <div class="walls-strip">
    <div class="wall-pill">123ä¸‡ï¼šæ‰€å¾—ç¨ï¼ˆç›®å®‰ï¼‰</div>
    <div class="wall-pill">106ä¸‡ï¼šç¤¾ä¿ï¼ˆ51äººä»¥ä¸Šãƒ»æœˆ8.8ä¸‡ï¼‰</div>
    <div class="wall-pill">130ä¸‡ï¼šç¤¾ä¿ï¼ˆæ‰¶é¤Šã‹ã‚‰å¤–ã‚Œã‚‹ç›®å®‰ï¼‰</div>
    <div class="wall-pill">160ä¸‡ï¼šé…å¶è€…ç‰¹åˆ¥æ§é™¤ï¼ˆæº€é¡ï¼‰</div>
  </div>
</div>

<div class="container">
  <div class="card anim-up">
    <div class="section-eyebrow">æƒ…å ±ã‚’å…¥åŠ›</div>

    <div class="slider-section">
      <div class="slider-display">
        <div class="s-label">ã‚ãªãŸï¼ˆãƒ‘ãƒ¼ãƒˆãƒ»ã‚¢ãƒ«ãƒã‚¤ãƒˆï¼‰ã®å¹´å</div>
        <span class="s-amount" id="income-display">120</span><span class="s-unit">ä¸‡å††</span>
      </div>
      <input type="range" id="income-slider" min="0" max="250" step="1" value="120" oninput="syncIncome(this.value)">
      <div class="slider-ticks">
        <span>0</span><span>50</span><span>100</span><span>150</span><span>200</span><span>250ä¸‡</span>
      </div>
    </div>

    <div class="form-grid">
      <div class="field">
        <label><strong>ã‚ãªãŸã®å¹´åï¼ˆæ‰‹å…¥åŠ›å¯ï¼‰</strong></label>
        <div class="input-wrap">
          <input type="number" id="income-input" value="120" min="0" max="999" oninput="syncIncome(this.value, true)">
          <span class="input-unit">ä¸‡å††</span>
        </div>
        <span class="field-hint">äº¤é€šè²»ã‚’é™¤ã„ãŸå¹´é–“çµ¦ä¸åå…¥ï¼ˆè³ä¸è¾¼ã¿ã®å ´åˆã¯ç›®å®‰ãŒã‚ºãƒ¬ã¾ã™ï¼‰</span>
      </div>

      <div class="field">
        <label>
          <strong>æ‰¶é¤Šã™ã‚‹å´ï¼ˆå¤«ãªã©ï¼‰ã®å¹´å</strong>
          <span class="tip" data-tip="ä¸–å¸¯æ‰‹å–ã‚Šï¼ˆæ¦‚ç®—ï¼‰ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã€ã§ãã‚‹ã ã‘å®Ÿéš›ã®çµ¦ä¸å¹´åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚é…å¶è€…æ§é™¤ãƒ»é…å¶è€…ç‰¹åˆ¥æ§é™¤ã®æ¸›é¡åŒºåˆ†ï¼ˆ1,095ä¸‡/1,145ä¸‡/1,195ä¸‡ï¼‰ã¯è‡ªå‹•åˆ¤å®šã•ã‚Œã¾ã™ã€‚">?</span>
        </label>

        <div class="input-wrap">
          <input type="number" id="spouse-income-input" value="500" min="0" max="9999" oninput="syncSpouseClassAuto()">
          <span class="input-unit">ä¸‡å††</span>
        </div>

        <div class="input-wrap" style="margin-top:10px;">
          <select id="spouse-income-class" onchange="onSpouseClassChanged()">
            <option value="auto" selected>æ§é™¤åŒºåˆ†ï¼šè‡ªå‹•ï¼ˆå¹´åã‹ã‚‰åˆ¤å®šï¼‰</option>
            <option value="A">æ§é™¤åŒºåˆ†ï¼šã€œ1,095ä¸‡å††ï¼ˆAï¼‰</option>
            <option value="B">æ§é™¤åŒºåˆ†ï¼š1,095ã€œ1,145ä¸‡å††ï¼ˆBï¼‰</option>
            <option value="C">æ§é™¤åŒºåˆ†ï¼š1,145ã€œ1,195ä¸‡å††ï¼ˆCï¼‰</option>
            <option value="over1195">æ§é™¤åŒºåˆ†ï¼š1,195ä¸‡å††è¶…ï¼ˆæ§é™¤ãªã—ï¼‰</option>
          </select>
        </div>

        <input type="hidden" id="spouse-income-class-auto" value="A">

        <span class="field-hint">â€»ã€Œæ§é™¤åŒºåˆ†ã€ã¯é…å¶è€…æ§é™¤ï¼ˆç‰¹åˆ¥æ§é™¤ï¼‰ã®æ¸›é¡åˆ¤å®šã«ã®ã¿ä½¿ç”¨ã—ã¾ã™ã€‚ä¸–å¸¯æ‰‹å–ã‚Šã®è¨ˆç®—ã¯ä¸Šã®å¹´åå…¥åŠ›ã‚’ä½¿ã„ã¾ã™ã€‚</span>
      </div>

      <div class="field">
        <label>
          <strong>ã‚ãªãŸã®å‹¤å‹™å…ˆã®å¾“æ¥­å“¡æ•°</strong>
          <span class="tip" data-tip="çŸ­æ™‚é–“åŠ´åƒè€…ã®ç¤¾ä¼šä¿é™ºåŠ å…¥è¦ä»¶ï¼ˆã„ã‚ã‚†ã‚‹106ä¸‡å††ç›¸å½“ï¼‰ã®å¯¾è±¡ã¯ã€ä¼æ¥­è¦æ¨¡ãªã©ã§æ±ºã¾ã‚Šã¾ã™ã€‚æ³•äººå…¨ä½“ã®åˆè¨ˆã§åˆ¤æ–­ã—ã¾ã™ã€‚">?</span>
        </label>
        <div class="input-wrap">
          <select id="company-size">
            <option value="large">51äººä»¥ä¸Šï¼ˆä¸­ã€œå¤§è¦æ¨¡ï¼‰</option>
            <option value="small">50äººä»¥ä¸‹ï¼ˆå°è¦æ¨¡ï¼‰</option>
            <option value="unknown">ã‚ã‹ã‚‰ãªã„</option>
          </select>
        </div>
        <span class="field-hint">æ³•äººå…¨ä½“ã®åˆè¨ˆå¾“æ¥­å“¡æ•°</span>
      </div>

      <div class="field">
        <label><strong>é€±ã®æ‰€å®šåŠ´åƒæ™‚é–“</strong></label>
        <div class="input-wrap">
          <input type="number" id="weekly-hours" value="25" min="1" max="60">
          <span class="input-unit">æ™‚é–“</span>
        </div>
        <span class="field-hint">æ®‹æ¥­é™¤ãå¥‘ç´„ä¸Šã®é€±æ™‚é–“</span>
      </div>

      <div class="field">
        <label>
          <strong>å­¦ç”Ÿï¼ˆæ˜¼é–“å­¦ç”Ÿç­‰ï¼‰ã§ã™ã‹ï¼Ÿ</strong>
          <span class="tip" data-tip="çŸ­æ™‚é–“åŠ´åƒè€…ã®åšç”Ÿå¹´é‡‘ãƒ»å¥åº·ä¿é™ºã®åŠ å…¥è¦ä»¶ã§ã¯ã€Œå­¦ç”Ÿã€ã¯åŸå‰‡å¯¾è±¡å¤–ã¨ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼ˆä¾‹å¤–ã‚ã‚Šï¼‰ã€‚">?</span>
        </label>
        <div class="input-wrap">
          <select id="is-student">
            <option value="no" selected>ã„ã„ãˆ</option>
            <option value="yes">ã¯ã„ï¼ˆå­¦ç”Ÿï¼‰</option>
          </select>
        </div>
        <span class="field-hint">å­¦ç”Ÿã‹ã©ã†ã‹ã§ 106ä¸‡å††ç›¸å½“ã®åˆ¤å®šãŒå¤‰ã‚ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™</span>
      </div>

      <div class="field">
        <label>
          <strong>é›‡ç”¨æœŸé–“ï¼š2ã‹æœˆè¶…ã®è¦‹è¾¼ã¿</strong>
          <span class="tip" data-tip="çŸ­æ™‚é–“åŠ´åƒè€…ã®åŠ å…¥è¦ä»¶ã§ã¯ã€Œ2ã‹æœˆã‚’è¶…ãˆã¦ä½¿ç”¨ã•ã‚Œã‚‹è¦‹è¾¼ã¿ã€ç­‰ãŒè¦ä»¶ã«å«ã¾ã‚Œã¾ã™ã€‚">?</span>
        </label>
        <div class="input-wrap">
          <select id="over-2months">
            <option value="yes" selected>ã¯ã„ï¼ˆ2ã‹æœˆè¶…ï¼‰</option>
            <option value="no">ã„ã„ãˆï¼ˆçŸ­æœŸï¼‰</option>
          </select>
        </div>
        <span class="field-hint">ä¸æ˜ãªå ´åˆã¯ã€Œã¯ã„ã€ã§OKï¼ˆå®‰å…¨å´ï¼‰<br>â€»æœˆ8.8ä¸‡å††ã®è³ƒé‡‘è¦ä»¶ã¯2026å¹´ä¸­ã€œ2028å¹´ã«æ’¤å»ƒäºˆå®šï¼ˆ2025å¹´6æœˆæˆç«‹ãƒ»æ–½è¡Œæ—¥æœªå®šï¼‰</span>
      </div>

      <div class="field">
        <label><strong>æ‰¶é¤Šã™ã‚‹äººã¨ã®é–¢ä¿‚</strong></label>
        <div class="input-wrap">
          <select id="relation">
            <option value="spouse">é…å¶è€…ï¼ˆå¤«ãƒ»å¦»ï¼‰</option>
            <option value="parent">è¦ªï¼ˆä»•é€ã‚Šç­‰ï¼‰</option>
            <option value="none">æ‰¶é¤Šè€…ãªã—ãƒ»ç‹¬èº«</option>
          </select>
        </div>
        <span class="field-hint">é…å¶è€…ã®å ´åˆã®ã¿é…å¶è€…æ§é™¤ï¼ˆå¤«å´ï¼‰ã‚’è¨ˆç®—</span>
      </div>

      <div class="field" id="spouse-age-field">
        <label><strong>ã‚ãªãŸï¼ˆãƒ‘ãƒ¼ãƒˆå´ï¼‰ã®å¹´é½¢</strong></label>
        <div class="input-wrap">
          <select id="your-age">
            <option value="under70">70æ­³æœªæº€</option>
            <option value="over70">70æ­³ä»¥ä¸Šï¼ˆè€äººæ§é™¤å¯¾è±¡ï¼‰</option>
          </select>
        </div>
        <span class="field-hint">70æ­³ä»¥ä¸Šã¯é…å¶è€…æ§é™¤ãŒå¢—é¡ã•ã‚Œã¾ã™</span>
      </div>
    </div>

    <button class="btn-primary" onclick="calculate()">æ‰¶é¤Šãƒ©ã‚¤ãƒ³ã‚’åˆ¤å®šã™ã‚‹ â†’</button>

    <div class="small-note">
      â€»ã€Œæœˆ8.8ä¸‡å††ä»¥ä¸Šã€ã¯å¹´åã‹ã‚‰æœˆåæ›ç®—ï¼ˆå¹´åÃ·12ï¼‰ã§åˆ¤å®šã—ã¦ã„ã¾ã™ã€‚è³ä¸ãƒ»æœˆã”ã¨ã®å¤‰å‹•ãŒå¤§ãã„å ´åˆã¯å®Ÿæ…‹ã¨ã‚ºãƒ¬ã¾ã™ã€‚
    </div>
  </div>

  <div id="result" style="display:none;">
    <div id="verdict-box" class="verdict">
      <div class="verdict-icon" id="verdict-icon"></div>
      <div class="verdict-title" id="verdict-title"></div>
      <div class="verdict-desc" id="verdict-desc"></div>
    </div>


    <div class="card" style="animation:none;">
      <div class="section-eyebrow">ã‚ãªãŸã¸ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹</div>
      <div class="advice-list" id="advice-list"></div>
    </div>

    


    <div class="walls-card">
      <div class="walls-card-head">WALL CHECK â€” å„ãƒ©ã‚¤ãƒ³ã¨ã®è·é›¢ï¼ˆç›®å®‰ï¼‰</div>
      <div id="walls-list"></div>
    </div>

    <div class="deduction-bar-card" id="deduction-section">
      <div class="deduction-bar-head">SPOUSE DEDUCTION â€” é…å¶è€…æ§é™¤ï¼ˆå¤«å´ï¼‰ã®çŠ¶æ³</div>
      <div id="deduction-rows"></div>
    </div>

    <!-- ã‚ãªãŸã®æ‰‹å–ã‚Šå†…è¨³ -->
    <div class="household-card">
      <div class="household-title">ã‚ãªãŸã®æ‰‹å–ã‚Šå†…è¨³ï¼ˆç¾åœ¨ã®å¹´åï¼‰</div>
      <div class="hh-grid" id="take-home-grid">
        <div class="hh-box">
          <div class="hh-label">ã‚ãªãŸã®æ‰‹å–ã‚Š</div>
          <div class="hh-amount" id="th-take">â€”</div>
          <div class="hh-sub" id="th-take-sub"></div>
        </div>
        <div class="hh-box" id="th-benefit-box" style="display:none">
          <div class="hh-label">é…å¶è€…æ§é™¤ã®ç¯€ç¨é¡ï¼ˆå¤«å´ï¼‰</div>
          <div class="hh-amount" id="th-benefit">â€”</div>
          <div class="hh-sub">å¤«ã®æ‰€å¾—ç¨ãŒè»½æ¸›ã•ã‚Œã‚‹åˆ†ï¼ˆæ¨è¨ˆï¼‰</div>
        </div>
      </div>
      <div id="th-breakdown" class="hh-diff" style="font-size:13px;line-height:1.9;text-align:left;padding:14px 20px;"></div>
    </div>

    <!-- å¹´ååˆ¥æ‰‹å–ã‚Šæ¯”è¼ƒãƒ†ãƒ¼ãƒ–ãƒ« -->
    <div class="deduction-bar-card">
      <div class="deduction-bar-head">INCOME SIMULATION â€” å¹´ååˆ¥ã®æ‰‹å–ã‚Šæ¯”è¼ƒ</div>
      <div style="padding:14px 24px 6px;font-size:12px;color:var(--muted);">ç¾åœ¨ã®å¹´åÂ±ã®ç¯„å›²ã§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€‚<strong style="color:var(--text)">å¤ªå­—</strong>ãŒç¾åœ¨ã®å¹´åã€‚</div>
      <div id="income-table" style="overflow-x:auto;"></div>
    </div>
<span class="reset-link" onclick="resetForm()">â† å…¥åŠ›ã‚’ã‚„ã‚Šç›´ã™</span>

    <div class="footer-note">
      â€»æœ¬ãƒ„ãƒ¼ãƒ«ã®è¨ˆç®—çµæœã¯æ¦‚ç®—ã§ã™ã€‚å®Ÿéš›ã®ç¨é¡ãƒ»æ‰‹å–ã‚Šé¡ã¯è‡ªæ²»ä½“ãƒ»å‹¤å‹™å…ˆãƒ»å„ç¨®æ§é™¤ãƒ»æ‰¶é¤Šå®¶æ—æ•°ãƒ»æœˆé¡è³ƒé‡‘ã®å®Ÿæ…‹ãªã©ã«ã‚ˆã‚Šç•°ãªã‚Šã¾ã™ã€‚é‡è¦ãªåˆ¤æ–­ã®å‰ã«ã¯ç¨ç†å£«ãƒ»ç¤¾ä¼šä¿é™ºåŠ´å‹™å£«ç­‰ã®å°‚é–€å®¶ã«ã”ç›¸è«‡ãã ã•ã„ã€‚<br>
      â€»æœ¬ãƒšãƒ¼ã‚¸ã¯ã€Œ2025å¹´ï¼ˆä»¤å’Œ7å¹´åˆ†ï¼‰ç¨åˆ¶æ”¹æ­£ã€ã‚’å‰æã«ã—ã¦ã„ã¾ã™ã€‚<strong>ç¤¾ä¼šä¿é™ºã®ä»Šå¾Œã®æ”¹æ­£ï¼šâ‘ æœˆé¡è³ƒé‡‘8.8ä¸‡å††è¦ä»¶ï¼ˆ106ä¸‡å††ã®å£ï¼‰ã¯2026å¹´ä¸­ã€œ2028å¹´6æœˆã«æ’¤å»ƒäºˆå®šã€â‘¡ä¼æ¥­è¦æ¨¡è¦ä»¶ï¼ˆ51äººä»¥ä¸Šï¼‰ã¯2027å¹´10æœˆã€œ2035å¹´10æœˆã«æ®µéšçš„æ’¤å»ƒï¼ˆå¹´é‡‘åˆ¶åº¦æ”¹æ­£æ³•ãƒ»2025å¹´6æœˆæˆç«‹ï¼‰ã€‚</strong> æ–½è¡Œæ—¥ã¯æ”¿ä»¤ã§ç¢ºå®šæ¬¡ç¬¬å¤‰ã‚ã‚Šã¾ã™ã€‚<br>
      â€»æ‰€å¾—ç¨ï¼šçµ¦ä¸æ‰€å¾—æ§é™¤ï¼ˆæœ€ä½65ä¸‡å††ï¼‰ãƒ»åŸºç¤æ§é™¤ï¼ˆåˆè¨ˆæ‰€å¾—ã«ã‚ˆã‚Šæ®µéšï¼‰ã‚’åæ˜ ã€‚ä½æ°‘ç¨ï¼šåŸºç¤æ§é™¤43ä¸‡å††ãƒ»æ‰€å¾—å‰²10%ãƒ»å‡ç­‰å‰²ï¼‹æ£®æ—ç’°å¢ƒç¨ï¼ˆåˆè¨ˆ5,500å††ç›¸å½“ï¼‰ã‚’ã€Œèª²ç¨ãƒ™ãƒ¼ã‚¹ãŒã‚ã‚‹å ´åˆã€ã«è¨ˆä¸Šï¼ˆæ¦‚ç®—ï¼‰ã€‚ç¤¾ä¼šä¿é™ºæ–™ç‡ï¼š14.15%ã‚’ä¾¿å®œä¸Šä½¿ç”¨ï¼ˆå®Ÿéš›ã¯å¥ä¿çµ„åˆãƒ»éƒ½é“åºœçœŒãƒ»å¹´åº¦ã§å¤‰å‹•ï¼‰ã€‚
    </div>
  </div>
</div>

<footer class="site-footer">
  Â© 2025 kurashicalc
  <a href="/privacy.html">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
  <a href="/contact.html">ãŠå•ã„åˆã‚ã›</a>
</footer>

<script>
const WALLS = [
  { amount:123, label:'æ‰€å¾—ç¨ã®ç›®å®‰ï¼ˆçµ¦ä¸åå…¥ï¼‰', desc:'çµ¦ä¸æ‰€å¾—æ§é™¤ï¼‹åŸºç¤æ§é™¤ã§ã€æ‰€å¾—ç¨ãŒ0ã«ãªã‚Šã‚„ã™ã„ç›®å®‰ï¼ˆå€‹åˆ¥äº‹æƒ…ã§å¤‰å‹•ï¼‰', color:'#a0720a' },
  { amount:106, label:'ç¤¾ä¼šä¿é™ºã®ç›®å®‰ï¼ˆ51äººä»¥ä¸Šãƒ»ç¾è¡Œï¼‰', desc:'ç¾è¡Œï¼šé€±20hä»¥ä¸Šãƒ»æœˆ8.8ä¸‡å††ä»¥ä¸Šãƒ»51äººä»¥ä¸Šãƒ»å­¦ç”Ÿé™¤å¤–ã€‚æœˆ8.8ä¸‡å††ã®è³ƒé‡‘è¦ä»¶ã¯2026å¹´ä¸­ã€œ2028å¹´ã«å»ƒæ­¢äºˆå®šã€‚ä¼æ¥­è¦æ¨¡è¦ä»¶ã‚‚2027å¹´ã€œ2035å¹´ã«æ®µéšçš„æ’¤å»ƒï¼ˆå¹´é‡‘åˆ¶åº¦æ”¹æ­£æ³•ãƒ»2025å¹´6æœˆæˆç«‹ï¼‰', color:'#c07a20', bigOnly:true },
  { amount:130, label:'ç¤¾ä¼šä¿é™ºã®ç›®å®‰ï¼ˆæ‰¶é¤Šã‹ã‚‰å¤–ã‚Œã‚‹ï¼‰', desc:'å¥åº·ä¿é™ºã®æ‰¶é¤Šï¼ˆè¢«æ‰¶é¤Šè€…ï¼‰ã‹ã‚‰å¤–ã‚Œã‚‹ç›®å®‰ã€‚å®Ÿå‹™ã¯ä¿é™ºè€…ã®åŸºæº–ã«ã‚ˆã‚Šåˆ¤å®š', color:'#c0392b' },
  { amount:160, label:'é…å¶è€…ç‰¹åˆ¥æ§é™¤ï¼ˆæº€é¡ï¼‰', desc:'ã“ã“ã¾ã§ã¯å¤«å´ã§38ä¸‡å††ã®æ§é™¤ãŒæº€é¡é©ç”¨ï¼ˆè¦ä»¶ã‚ã‚Šï¼‰ã€‚è¶…ãˆã‚‹ã¨æ®µéšçš„ã«æ¸›é¡', color:'#6d28d9' },
];

function empDed(income) {
  if (income <= 162.5) return 65;
  if (income <= 180)   return income * 0.4 - 10;
  if (income <= 360)   return income * 0.3 + 8;
  if (income <= 660)   return income * 0.2 + 44;
  if (income <= 850)   return income * 0.1 + 110;
  return 195;
}

function basicDedIT(income) {
  const netIncome = Math.max(0, income - empDed(income));
  if (netIncome <= 132) return 95;
  if (netIncome <= 336) return 88;
  if (netIncome <= 489) return 68;
  if (netIncome <= 655) return 63;
  if (netIncome <= 2350) return 58;
  if (netIncome <= 2400) return 48;
  if (netIncome <= 2450) return 32;
  if (netIncome <= 2500) return 16;
  return 0;
}

function incomeTaxFromTaxable(t) {
  if (t <= 0)    return 0;
  if (t <= 195)  return t * 0.05;
  if (t <= 330)  return 9.75  + (t - 195)  * 0.10;
  if (t <= 695)  return 23.25 + (t - 330)  * 0.20;
  if (t <= 900)  return 96.25 + (t - 695)  * 0.23;
  if (t <= 1800) return 143.4 + (t - 900)  * 0.33;
  if (t <= 4000) return 440.4 + (t - 1800) * 0.40;
  return 1320.4  + (t - 4000) * 0.45;
}

function residentTaxApprox(income, socialIns, includeKintoWari=true, spouseDed=0) {
  const ded = empDed(income);
  const base = Math.max(0, income - ded - 43 - socialIns - spouseDed); // ä½æ°‘ç¨ã®èª²ç¨ãƒ™ãƒ¼ã‚¹ï¼ˆæ¦‚ç®—ï¼‰
  if (base <= 0) return 0;
  const kinto = includeKintoWari ? 0.55 : 0; // å‡ç­‰å‰²ï¼‹æ£®æ—ç’°å¢ƒç¨ï¼ˆæ¦‚ç®—ï¼‰
  return base * 0.10 + kinto;
}

function needSocialInsurance(income, isBig, hours, isStudent, over2months) {
  const monthly = income / 12; // ä¸‡å††
  const shortTimeEligible = isBig && hours >= 20 && monthly >= 8.8 && !isStudent && over2months;
  const loseDependent = income >= 130;
  return shortTimeEligible || loseDependent;
}

function calcPartTake(income, isBig, hours, isStudent, over2months) {
  const needSocial = needSocialInsurance(income, isBig, hours, isStudent, over2months);
  const socialIns  = needSocial ? income * 0.1415 : 0;

  const ded    = empDed(income);
  const basic  = basicDedIT(income);
  const taxIT  = Math.max(0, income - ded - basic - socialIns);
  const incomeTax = incomeTaxFromTaxable(taxIT);

  const residentTax = residentTaxApprox(income, socialIns, true);

  const take = income - socialIns - incomeTax - residentTax;
  return { take, socialIns, incomeTax, residentTax, needSocial };
}

function calcSpouseDeduction(partIncome, spouseIncome, isOld, spouseClassOverride=null) {
  let cls;
  if (spouseClassOverride && spouseClassOverride !== 'auto') {
    cls = spouseClassOverride;
  } else 
  if (spouseIncome > 1195) {
    return { deductionType: 'none', deductionAmount: 0, spouseIncomeClass: 'over1195' };
  } else if (spouseIncome > 1145) cls = 'C';
  else if   (spouseIncome > 1095) cls = 'B';
  else                             cls = 'A';

  const partNet = Math.max(0, partIncome - empDed(partIncome));

  if (partNet <= 58) {
    const base = isOld ? { A:48, B:32, C:16 } : { A:38, B:26, C:13 };
    return { deductionType: 'control', deductionAmount: base[cls], spouseIncomeClass: cls };
  }

  if (partNet > 133) {
    return { deductionType: 'none', deductionAmount: 0, spouseIncomeClass: cls };
  }

  const tableA = [
    { max:  95, A:38, B:26, C:13 },
    { max: 100, A:36, B:24, C:12 },
    { max: 105, A:31, B:21, C:11 },
    { max: 110, A:26, B:18, C: 9 },
    { max: 115, A:21, B:14, C: 7 },
    { max: 120, A:16, B:11, C: 6 },
    { max: 125, A:11, B: 8, C: 4 },
    { max: 130, A: 6, B: 4, C: 2 },
    { max: 133, A: 3, B: 2, C: 1 },
  ];
  for (const row of tableA) {
    if (partNet <= row.max) {
      return { deductionType: 'special', deductionAmount: row[cls], spouseIncomeClass: cls };
    }
  }
  return { deductionType: 'none', deductionAmount: 0, spouseIncomeClass: cls };
}

// ============================================================
// ä½æ°‘ç¨ï¼šé…å¶è€…æ§é™¤ï¼é…å¶è€…ç‰¹åˆ¥æ§é™¤ï¼ˆæ¦‚ç®—ï¼‰
// ãƒ»é…å¶è€…æ§é™¤ï¼šä¸€èˆ¬ 33ä¸‡å††ã€è€äººæ§é™¤å¯¾è±¡é…å¶è€… 38ä¸‡å††ï¼ˆæ‰¶é¤Šè€…ã®æ‰€å¾—åŒºåˆ†ã§æ®µéšçš„ã«æ¸›é¡ï¼‰
// ãƒ»é…å¶è€…ç‰¹åˆ¥æ§é™¤ï¼šæœ€å¤§ 33ä¸‡å††ï¼ˆæ®µéšçš„ã«æ¸›é¡ï¼‰
// â€» è¡¨ã¯è‡ªæ²»ä½“ç­‰ã§å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ä¸€èˆ¬çš„ãªä¸€è¦§è¡¨ã«æ²¿ã£ãŸè¿‘ä¼¼ï¼ˆä½æ°‘ç¨ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
// ============================================================
function calcSpouseDeductionResident(partIncome, spouseIncome, isOld) {
  let cls;
  if (spouseIncome > 1195) {
    return { deductionType: 'none', deductionAmount: 0, spouseIncomeClass: 'over1195' };
  } else if (spouseIncome > 1145) cls = 'C';
  else if   (spouseIncome > 1095) cls = 'B';
  else                             cls = 'A';

  const partNet = Math.max(0, partIncome - empDed(partIncome)); // é…å¶è€…ï¼ˆãƒ‘ãƒ¼ãƒˆå´ï¼‰ã®åˆè¨ˆæ‰€å¾—ï¼ˆçµ¦ä¸æ‰€å¾—ï¼‰

  // é…å¶è€…æ§é™¤ï¼ˆåˆè¨ˆæ‰€å¾—58ä¸‡å††ä»¥ä¸‹ï¼‰
  if (partNet <= 58) {
    const base = isOld ? { A:38, B:26, C:13 } : { A:33, B:22, C:11 };
    return { deductionType: 'control', deductionAmount: base[cls], spouseIncomeClass: cls };
  }

  // é…å¶è€…ç‰¹åˆ¥æ§é™¤ï¼ˆåˆè¨ˆæ‰€å¾—58ä¸‡è¶…ã€œ133ä¸‡ä»¥ä¸‹ï¼‰
  if (partNet > 133) {
    return { deductionType: 'none', deductionAmount: 0, spouseIncomeClass: cls };
  }

  // ä½æ°‘ç¨ã®é…å¶è€…ç‰¹åˆ¥æ§é™¤ï¼ˆæœ€å¤§33ä¸‡å††ï¼‰ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆæ¦‚ç®—ï¼‰
  const table = [
    { max: 100, A:33, B:22, C:11 },
    { max: 105, A:31, B:21, C:11 },
    { max: 110, A:26, B:18, C: 9 },
    { max: 115, A:21, B:14, C: 7 },
    { max: 120, A:16, B:11, C: 6 },
    { max: 125, A:11, B: 8, C: 4 },
    { max: 130, A: 6, B: 4, C: 2 },
    { max: 133, A: 3, B: 2, C: 1 },
  ];
  for (const row of table) {
    if (partNet <= row.max) {
      return { deductionType: 'special', deductionAmount: row[cls], spouseIncomeClass: cls };
    }
  }
  return { deductionType: 'none', deductionAmount: 0, spouseIncomeClass: cls };
}


function calcSpouseTaxSaving(spouseIncome, deductionAmount) {
  if (deductionAmount === 0) return 0;
  const ded    = empDed(spouseIncome);
  const basic  = basicDedIT(spouseIncome);
  const socialIns = spouseIncome * 0.1415;
  const taxable = Math.max(0, spouseIncome - ded - basic - socialIns);
  const taxWith    = incomeTaxFromTaxable(Math.max(0, taxable - deductionAmount));
  const taxWithout = incomeTaxFromTaxable(taxable);
  return Math.max(0, taxWithout - taxWith);
}

function calcHouseholdTake(partIncome, spouseIncome, isBig, hours, isOld, isSpouse, isStudent, over2months) {
  const part = calcPartTake(partIncome, isBig, hours, isStudent, over2months);

  const spouseDed     = empDed(spouseIncome);
  const spouseBasic   = basicDedIT(spouseIncome);
  const spouseSocial  = spouseIncome * 0.1415;
  let spouseDeductionAmount = 0;

  if (isSpouse) {
    const { deductionAmount } = calcSpouseDeduction(partIncome, spouseIncome, isOld, getSpouseClass(spouseIncome));
    spouseDeductionAmount = deductionAmount;
  }

  const spouseTaxable  = Math.max(0, spouseIncome - spouseDed - spouseBasic - spouseSocial - spouseDeductionAmount);
  const spouseIT       = incomeTaxFromTaxable(spouseTaxable);
  const spouseResidentDed = isSpouse ? calcSpouseDeductionResident(partIncome, spouseIncome, isOld, getSpouseClass(spouseIncome)).deductionAmount : 0;
  const spouseRT       = residentTaxApprox(spouseIncome, spouseSocial, true, spouseResidentDed);
  const spouseTake     = spouseIncome - spouseSocial - spouseIT - spouseRT;

  return {
    partTake:   part.take,
    spouseTake,
    total:      part.take + spouseTake,
    partDetail: part,
    spouseDeductionAmount,
  };
}

function fmt(n)  { return (Math.round(n * 10) / 10) + 'ä¸‡å††'; }
function fmtI(n) { return Math.round(n).toLocaleString() + 'ä¸‡å††'; }

function syncIncome(val, fromInput) {
  const n = Math.min(parseFloat(val) || 0, fromInput ? 999 : 250);
  document.getElementById('income-display').textContent = Math.round(n);
  if (!fromInput) document.getElementById('income-input').value  = Math.round(n);
  if (n <= 250)   document.getElementById('income-slider').value = Math.round(n);
}




function spouseIncomeToClass(spouseIncome) {
  if (spouseIncome > 1195) return 'over1195';
  if (spouseIncome > 1145) return 'C';
  if (spouseIncome > 1095) return 'B';
  return 'A';
}

function getSpouseClass(spouseIncome) {
  const sel = document.getElementById('spouse-income-class')?.value || 'auto';
  if (sel === 'auto') return spouseIncomeToClass(spouseIncome);
  return sel;
}

function syncSpouseClassAuto() {
  const spouseIncome = parseFloat(document.getElementById('spouse-income-input').value) || 0;
  const cls = spouseIncomeToClass(spouseIncome);
  const hidden = document.getElementById('spouse-income-class-auto');
  if (hidden) hidden.value = cls;
}

function onSpouseClassChanged() {
  // ä»Šã¯ç‰¹ã«å‡¦ç†ãªã—ï¼ˆå°†æ¥è¡¨ç¤ºã‚’å¤‰ãˆãŸã„å ´åˆã®ãƒ•ãƒƒã‚¯ï¼‰
}

function calculate() {
  const income       = parseFloat(document.getElementById('income-input').value)   || 0;
  const spouseIncome = parseFloat(document.getElementById('spouse-income-input').value) || 0;
const companySel   = document.getElementById('company-size').value;
  const isBig        = (companySel === 'large') || (companySel === 'unknown');

  const hours        = parseFloat(document.getElementById('weekly-hours').value)   || 0;
  const relation     = document.getElementById('relation').value;
  const isOld        = document.getElementById('your-age').value === 'over70';
  const isSpouse     = relation === 'spouse';

  const isStudent    = document.getElementById('is-student').value === 'yes';
  const over2months  = document.getElementById('over-2months').value === 'yes';

  const current = calcHouseholdTake(income, spouseIncome, isBig, hours, isOld, isSpouse, isStudent, over2months);

  const result = document.getElementById('result');
  result.style.display = 'block';
  setTimeout(() => result.scrollIntoView({ behavior:'smooth', block:'start' }), 50);

  const box = document.getElementById('verdict-box');
  box.className = 'verdict';

  const needSocial = needSocialInsurance(income, isBig, hours, isStudent, over2months);
  const monthlyWageOK = (income/12) >= 8.8;

  let headline = '';
  let desc = '';

  if (!needSocial && income < 123) {
    box.classList.add('safe');
    document.getElementById('verdict-icon').textContent  = 'âœ…';
    headline = 'å¤§ããªå£ã¯è¶…ãˆã¦ã„ãªã„å¯èƒ½æ€§ãŒé«˜ã„ã§ã™';
    desc = `å¹´å <strong>${fmtI(income)}</strong> ã¯ã€ç¨é‡‘ãƒ»ç¤¾ä¼šä¿é™ºãŒç™ºç”Ÿã—ã«ãã„ç¯„å›²ã«åã¾ã£ã¦ã„ã¾ã™ï¼ˆå€‹åˆ¥äº‹æƒ…ã§å¤‰å‹•ï¼‰ã€‚`;
  } else if (needSocial && income < 130) {
    box.classList.add('warn');
    document.getElementById('verdict-icon').textContent  = 'âš ï¸';
    headline = 'ç¤¾ä¼šä¿é™ºï¼ˆçŸ­æ™‚é–“åŠ´åƒè€…ï¼‰ã«è©²å½“ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™';
    desc = `é€± <strong>${hours}æ™‚é–“</strong>ã€æœˆåæ›ç®— <strong>${fmt(income/12)}</strong>ã€å­¦ç”Ÿï¼š<strong>${isStudent ? 'ã¯ã„' : 'ã„ã„ãˆ'}</strong>ã€2ã‹æœˆè¶…ï¼š<strong>${over2months ? 'ã¯ã„' : 'ã„ã„ãˆ'}</strong> ã‹ã‚‰åˆ¤å®šã—ã¾ã—ãŸã€‚`;
    if (!monthlyWageOK) {
      desc += `<br>â€» æœˆ8.8ä¸‡å††æœªæº€ã®ãŸã‚ã€çŸ­æ™‚é–“åŠ å…¥è¦ä»¶ã®ã€Œè³ƒé‡‘è¦ä»¶ã€ã¯æº€ãŸã—ã¦ã„ã¾ã›ã‚“ï¼ˆå¹´åÃ·12æ›ç®—ï¼‰ã€‚`;
    }
  } else if (income >= 130) {
    box.classList.add('danger');
    document.getElementById('verdict-icon').textContent  = 'ğŸ”´';
    headline = 'æ‰¶é¤Šã‚’å¤–ã‚Œã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã§ã™ï¼ˆ130ä¸‡å††ç›®å®‰ï¼‰';
    desc = `å¹´å <strong>${fmtI(income)}</strong> ã¯ã€å¥åº·ä¿é™ºã®æ‰¶é¤Šåˆ¤å®šï¼ˆ130ä¸‡å††ç›®å®‰ï¼‰ã‚’è¶…ãˆã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ç¤¾ä¼šä¿é™ºæ–™ãƒ»ç¨é‡‘ã®å½±éŸ¿ã‚’ä¸‹ã§ç¢ºèªã—ã¦ãã ã•ã„ã€‚`;
  } else {
    box.classList.add('warn');
    document.getElementById('verdict-icon').textContent  = 'âš ï¸';
    headline = 'ç¨é‡‘ã®å½±éŸ¿ãŒå‡ºå§‹ã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™';
    desc = `å¹´å <strong>${fmtI(income)}</strong> ã¯ã€æ‰€å¾—ç¨ãƒ»ä½æ°‘ç¨ãŒç™ºç”Ÿã—å§‹ã‚ã‚‹ç¯„å›²ã«å…¥ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼ˆæ§é™¤çŠ¶æ³ã§å¤‰å‹•ï¼‰ã€‚`;
  }

  document.getElementById('verdict-title').textContent = headline;
  document.getElementById('verdict-desc').innerHTML    = desc;

  const list = document.getElementById('walls-list');
  list.innerHTML = '';
  WALLS.forEach(w => {
    if (w.bigOnly && !isBig) return;

    const diff = income - w.amount;
    const pct  = Math.min(100, (income / w.amount) * 100);
    let badge, cls;
    if      (diff >=  5) { badge = 'è¶…é';   cls = 'over'; }
    else if (diff >= -5) { badge = 'è¦æ³¨æ„'; cls = 'near'; }
    else                 { badge = 'ä½™è£•';   cls = 'under'; }
    const margin = diff >= 0 ? `+${diff.toFixed(0)}ä¸‡è¶…` : `æ®‹ã‚Š${Math.abs(diff).toFixed(0)}ä¸‡`;

    const row = document.createElement('div');
    row.className = 'wall-row';
    row.innerHTML = `
      <div class="wall-amount" style="color:${w.color}">${w.amount}ä¸‡</div>
      <div class="wall-info">
        <div class="wall-name">${w.label}</div>
        <div class="wall-desc">${w.desc}</div>
        <div class="wall-bar-wrap">
          <div class="wall-bar-fill" style="width:${pct}%;background:${w.color};opacity:0.5;"></div>
        </div>
      </div>
      <div class="wall-badge ${cls}">${badge}</div>
      <div class="wall-margin">${margin}</div>`;
    list.appendChild(row);
  });

  const dedSection = document.getElementById('deduction-section');
  const dedRows    = document.getElementById('deduction-rows');

  if (!isSpouse) {
    dedSection.style.display = 'none';
  } else {
    dedSection.style.display = 'block';
    const { deductionType, deductionAmount, spouseIncomeClass } =
      calcSpouseDeduction(income, spouseIncome, isOld, getSpouseClass(spouseIncome));
    const taxSaving = calcSpouseTaxSaving(spouseIncome, deductionAmount);

    const typeLabel = {
      control: 'é…å¶è€…æ§é™¤ï¼ˆã‚ãªãŸã®å¹´å123ä¸‡å††ä»¥ä¸‹ã®ç›®å®‰ï¼‰',
      special: 'é…å¶è€…ç‰¹åˆ¥æ§é™¤ï¼ˆã‚ãªãŸã®å¹´åãŒ123ä¸‡å††è¶…ã€œã®ç¯„å›²ï¼‰',
      none:    'æ§é™¤ãªã—',
    }[deductionType];

    const clsLabel = {
      A: `æ‰¶é¤Šã™ã‚‹å´ã®å¹´åã€œ1,095ä¸‡å††ï¼ˆæº€é¡é©ç”¨ï¼‰`,
      B: `æ‰¶é¤Šã™ã‚‹å´ã®å¹´å1,095ã€œ1,145ä¸‡å††ï¼ˆæ¸›é¡â‘ ï¼‰`,
      C: `æ‰¶é¤Šã™ã‚‹å´ã®å¹´å1,145ã€œ1,195ä¸‡å††ï¼ˆæ¸›é¡â‘¡ï¼‰`,
      over1195: `æ‰¶é¤Šã™ã‚‹å´ã®çµ¦ä¸åå…¥1,195ä¸‡å††è¶…ï¼ˆæ§é™¤ãªã—ï¼‰`,
    }[spouseIncomeClass] || '';

    dedRows.innerHTML = `
      <div class="ded-row">
        <div class="ded-label">
          <strong>æ§é™¤ã®ç¨®é¡</strong>${typeLabel}
        </div>
        <div class="ded-amount ${deductionAmount > 0 ? 'active' : 'zero'}">
          ${deductionAmount > 0 ? deductionAmount + 'ä¸‡å††' : '0å††'}
        </div>
      </div>
      <div class="ded-row">
        <div class="ded-label">
          <strong>æ‰¶é¤Šã™ã‚‹å´ã®æ‰€å¾—åŒºåˆ†</strong>${clsLabel}
        </div>
        <div class="ded-amount" style="font-size:12px;color:var(--muted)">å‚è€ƒ</div>
      </div>
      <div class="ded-row">
        <div class="ded-label">
          <strong>æ‰¶é¤Šã™ã‚‹å´ã®ç¯€ç¨é¡ï¼ˆæ¨è¨ˆï¼‰</strong>
          æ§é™¤ã«ã‚ˆã£ã¦æ‰€å¾—ç¨ãŒè»½æ¸›ã•ã‚Œã‚‹é‡‘é¡ï¼ˆæ¦‚ç®—ï¼‰
        </div>
        <div class="ded-amount ${taxSaving > 0 ? 'active' : 'zero'}">
          ${taxSaving > 0 ? 'â–²' + fmt(taxSaving) : '0å††'}
        </div>
      </div>`;
  }

  // â”€â”€ ã‚ãªãŸã®æ‰‹å–ã‚Šå†…è¨³ â”€â”€
  const p = current.partDetail;
  const taxSavingCurrent = isSpouse
    ? calcSpouseTaxSaving(spouseIncome, calcSpouseDeduction(income, spouseIncome, isOld, getSpouseClass(spouseIncome)).deductionAmount)
    : 0;

  document.getElementById('th-take').textContent = fmtI(current.partTake);
  document.getElementById('th-take-sub').textContent = `å¹´å${fmtI(income)}ã‹ã‚‰ç¨ãƒ»ç¤¾ä¿ã‚’å¼•ã„ãŸé¡`;

  const benefitBox = document.getElementById('th-benefit-box');
  if (isSpouse && taxSavingCurrent > 0) {
    benefitBox.style.display = 'block';
    document.getElementById('th-benefit').textContent = 'â–²' + fmtI(taxSavingCurrent);
  } else {
    benefitBox.style.display = 'none';
  }

  const breakdownLines = [
    `å¹´åï¼š${fmtI(income)}`,
    `ã€€- ç¤¾ä¼šä¿é™ºæ–™ï¼š${fmtI(p.socialIns)}ï¼ˆ${p.needSocial ? 'åŠ å…¥ã‚ã‚Š' : 'æ‰¶é¤Šå†…ãƒ»åŠ å…¥ãªã—'}ï¼‰`,
    `ã€€- æ‰€å¾—ç¨ï¼š${fmtI(p.incomeTax)}`,
    `ã€€- ä½æ°‘ç¨ï¼š${fmtI(p.residentTax)}`,
    `ã€€ï¼ æ‰‹å–ã‚Šï¼š<strong>${fmtI(current.partTake)}</strong>`,
  ];
  if (isSpouse && taxSavingCurrent > 0) {
    breakdownLines.push(`ã€€ï¼‹ é…å¶è€…æ§é™¤ã«ã‚ˆã‚‹å¤«ã®ç¯€ç¨ï¼ˆæ¨è¨ˆï¼‰ï¼š<strong>â–²${fmtI(taxSavingCurrent)}</strong>`);
    breakdownLines.push(`ã€€â†’ å®Ÿè³ªçš„ãªç¨¼ãï¼ˆæ‰‹å–ã‚Šï¼‹ç¯€ç¨ï¼‰ï¼š<strong>${fmtI(current.partTake + taxSavingCurrent)}</strong>`);
  }
  document.getElementById('th-breakdown').innerHTML = breakdownLines.join('<br>');

  // â”€â”€ å¹´ååˆ¥æ¯”è¼ƒãƒ†ãƒ¼ãƒ–ãƒ« â”€â”€
  function buildIncomeList(base) {
    const keyPoints = [0, 50, 80, 100, 105, 110, 120, 123, 125, 130, 140, 150, 160, 170, 180, 190, 200, 210, 250];
    if (isBig && hours >= 20) keyPoints.push(106);
    const nearby = [];
    for (let v = Math.max(0, base - 30); v <= base + 40; v += 5) nearby.push(v);
    const all = [...new Set([...keyPoints, ...nearby, base])].sort((a, b) => a - b);
    return all.filter(v => v >= Math.max(0, base - 30) && v <= base + 40);
  }

  const tableIncomes = buildIncomeList(income);
  const tableEl = document.getElementById('income-table');
  let tableHTML = `<table style="width:100%;border-collapse:collapse;font-size:12px;font-family:'DM Mono',monospace;">
    <thead><tr style="background:var(--bg2);border-bottom:2px solid var(--border);">
      <th style="padding:10px 16px;text-align:left;font-size:11px;letter-spacing:.1em;color:var(--muted);">å¹´å</th>
      <th style="padding:10px 8px;text-align:right;color:var(--muted);">æ‰‹å–ã‚Š</th>
      <th style="padding:10px 8px;text-align:right;color:var(--muted);">ç¤¾ä¿</th>
      <th style="padding:10px 8px;text-align:right;color:var(--muted);">æ‰€å¾—ç¨</th>
      <th style="padding:10px 8px;text-align:right;color:var(--muted);">ä½æ°‘ç¨</th>
      ${isSpouse ? '<th style="padding:10px 8px;text-align:right;color:var(--muted);">é…å¶è€…æ§é™¤</th>' : ''}
      <th style="padding:10px 16px;text-align:left;color:var(--muted);">ãƒ¡ãƒ¢</th>
    </tr></thead><tbody>`;

  tableIncomes.forEach(v => {
    const r = calcPartTake(v, isBig, hours, isStudent, over2months);
    const ded = isSpouse ? calcSpouseDeduction(v, spouseIncome, isOld) : null;
    const isCurrent = v === income;
    const rowStyle = isCurrent
      ? 'background:var(--bg2);font-weight:700;border-left:3px solid var(--accent);'
      : 'border-left:3px solid transparent;';

    const memos = [];
    if (v === 110) memos.push('ä½æ°‘ç¨ã®ç›®å®‰');
    if (v === 123) memos.push('æ‰€å¾—ç¨ãƒ»é…å¶è€…æ§é™¤ã®ç›®å®‰');
    if (v === 106 && isBig && hours >= 20) memos.push('ç¤¾ä¿åŠ å…¥ç›®å®‰ï¼ˆå¤§ä¼æ¥­ï¼‰');
    if (v === 130) memos.push('æ‰¶é¤Šã‹ã‚‰å¤–ã‚Œã‚‹ç›®å®‰');
    if (v === 160) memos.push('é…å¶è€…ç‰¹åˆ¥æ§é™¤ æº€é¡ä¸Šé™');
    if (v === 201) memos.push('é…å¶è€…ç‰¹åˆ¥æ§é™¤ çµ‚äº†');

    const dedAmt = ded ? ded.deductionAmount : null;

    tableHTML += `<tr style="${rowStyle}border-bottom:1px solid var(--border);">
      <td style="padding:9px 16px;white-space:nowrap;">${isCurrent ? 'â–¶ ' : ''}${v}ä¸‡å††</td>
      <td style="padding:9px 8px;text-align:right;color:var(--accent);font-weight:600;">${fmtI(r.take)}</td>
      <td style="padding:9px 8px;text-align:right;color:${r.needSocial ? 'var(--red)' : 'var(--muted)'};">${r.socialIns > 0 ? fmtI(r.socialIns) : 'â€”'}</td>
      <td style="padding:9px 8px;text-align:right;">${r.incomeTax > 0 ? fmtI(r.incomeTax) : 'â€”'}</td>
      <td style="padding:9px 8px;text-align:right;">${r.residentTax > 0 ? fmtI(r.residentTax) : 'â€”'}</td>
      ${isSpouse ? `<td style="padding:9px 8px;text-align:right;color:${dedAmt > 0 ? 'var(--green)' : 'var(--muted)'};">${dedAmt > 0 ? dedAmt + 'ä¸‡' : 'â€”'}</td>` : ''}
      <td style="padding:9px 16px;color:var(--muted);font-size:11px;">${memos.join(' / ')}</td>
    </tr>`;
  });
  tableHTML += '</tbody></table>';
  tableEl.innerHTML = tableHTML;

  const advices = [];
  const shortTimeEligible = isBig && hours >= 20 && (income/12) >= 8.8 && !isStudent && over2months;

  if (!needSocialInsurance(income, isBig, hours, isStudent, over2months)) {
    advices.push('ç¾æ™‚ç‚¹ã§ã¯ç¤¾ä¼šä¿é™ºåŠ å…¥ãŒç™ºç”Ÿã—ã«ãã„æ¡ä»¶ã§ã™ï¼ˆãŸã ã—ä¿é™ºè€…ãƒ»å‹¤å‹™å®Ÿæ…‹ã§å¤‰ã‚ã‚Šã¾ã™ï¼‰ã€‚');
  } else {
    if (shortTimeEligible) {
      advices.push(`<strong>çŸ­æ™‚é–“åŠ´åƒè€…ã®ç¤¾ä¼šä¿é™ºåŠ å…¥</strong>ã«è©²å½“ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ç¤¾ä¼šä¿é™ºæ–™ï¼ˆæ¦‚ç®—ï¼šå¹´${fmt(p.socialIns)}ï¼‰ãŒç™ºç”Ÿã—ã¦ã„ã‚‹å‰æã§è¨ˆç®—ã—ã¾ã—ãŸã€‚`);
    } else if (income >= 130) {
      advices.push(`<strong>130ä¸‡å††ã®ç›®å®‰</strong>ã‚’è¶…ãˆã¦ã„ã¾ã™ã€‚å¥åº·ä¿é™ºã®æ‰¶é¤Šã‹ã‚‰å¤–ã‚Œã‚‹å¯èƒ½æ€§ãŒé«˜ãã€ä¿é™ºæ–™è² æ‹…ãŒç™ºç”Ÿã—ã‚„ã™ã„å¸¯ã§ã™ï¼ˆä¿é™ºè€…åŸºæº–ã§åˆ¤å®šï¼‰ã€‚`);
    } else {
      advices.push('ç¤¾ä¼šä¿é™ºã®åˆ¤å®šã¯ç´°ç›®ãŒå¤šã„ã§ã™ã€‚å‹¤å‹™å…ˆã®äººäº‹ãƒ»ä¿é™ºè€…ã¸æ¡ä»¶ç¢ºèªã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚');
    }
  }

  if (income < 123) advices.push('æ‰€å¾—ç¨ã¯ç™ºç”Ÿã—ã«ãã„ç¯„å›²ã§ã™ï¼ˆæ§é™¤ã‚„ä¿é™ºæ–™ã§å¤‰å‹•ï¼‰ã€‚');
  else advices.push('æ‰€å¾—ç¨ã¯ç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼ˆæ§é™¤ãƒ»ä¿é™ºæ–™ã®çŠ¶æ³ã§å¤‰å‹•ï¼‰ã€‚');

  if (isSpouse) {
    const { deductionAmount, deductionType } = calcSpouseDeduction(income, spouseIncome, isOld, getSpouseClass(spouseIncome));
    const taxSaving = calcSpouseTaxSaving(spouseIncome, deductionAmount);
    if (deductionAmount > 0) {
      advices.push(`æ‰¶é¤Šã™ã‚‹å´ã§ã¯<strong>${deductionType === 'control' ? 'é…å¶è€…æ§é™¤' : 'é…å¶è€…ç‰¹åˆ¥æ§é™¤'}ï¼ˆ${deductionAmount}ä¸‡å††ï¼‰</strong>ãŒé©ç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€æ‰€å¾—ç¨ãŒæ¨è¨ˆç´„${fmt(taxSaving)}è»½æ¸›ã•ã‚Œã¦ã„ã¾ã™ã€‚`);
    } else {
      advices.push('æ‰¶é¤Šã™ã‚‹å´ã®å¹´åã‚„ã‚ãªãŸã®å¹´åã«ã‚ˆã‚Šã€é…å¶è€…æ§é™¤ï¼ˆç‰¹åˆ¥æ§é™¤ï¼‰ãŒé©ç”¨ã•ã‚Œãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚');
    }
  }

  advices.push('ã“ã®è¨ˆç®—ã¯æ¦‚ç®—ã§ã™ã€‚æœˆçµ¦ãƒ»è³ä¸ãƒ»æ§é™¤ï¼ˆç”Ÿå‘½ä¿é™ºæ–™æ§é™¤ãªã©ï¼‰ãƒ»æ‰¶é¤Šäººæ•°ãƒ»è‡ªæ²»ä½“å·®ã«ã‚ˆã£ã¦çµæœã¯å¤‰ã‚ã‚Šã¾ã™ã€‚');

  const advEl = document.getElementById('advice-list');
  advEl.innerHTML = '';
  advices.forEach((a, i) => {
    const d = document.createElement('div');
    d.className = 'advice-item';
    d.innerHTML = `<span class="advice-num">0${i + 1}</span><span>${a}</span>`;
    advEl.appendChild(d);
  });
}

function resetForm() {
  document.getElementById('result').style.display = 'none';
  window.scrollTo({ top:0, behavior:'smooth' });
}

// åˆæœŸåŒ–
syncSpouseClassAuto();


</script>
</body>
</html>
